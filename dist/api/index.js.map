{"version":3,"sources":["../../src/api/index.js"],"names":["config","db","api","use","get","req","res","parsedLanguage","parse","headers","language","code","region","platform","type","release","arch","json","ip"],"mappings":";;;;;;AAAA;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;kBAEe,gBAAoB;AAAA,KAAjBA,MAAiB,QAAjBA,MAAiB;AAAA,KAATC,EAAS,QAATA,EAAS;;AAClC,KAAIC,MAAM,sBAAV;;AAEA;AACAA,KAAIC,GAAJ,CAAQ,SAAR,EAAmB,sBAAO,EAAEH,cAAF,EAAUC,MAAV,EAAP,CAAnB;;AAEA;AACAC,KAAIE,GAAJ,CAAQ,SAAR,EAAmB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChC,MAAMC,iBAAiB,+BAAqBC,KAArB,CAA2BH,IAAII,OAAJ,CAAY,iBAAZ,CAA3B,CAAvB;AACA,MAAMC,WAAcH,eAAe,CAAf,EAAkBI,IAAhC,SAAwCJ,eAAe,CAAf,EAAkBK,MAAhE;AACA,MAAMC,WAAc,aAAGC,IAAH,EAAd,UAA4B,aAAGC,OAAH,EAA5B,UAA6C,aAAGF,QAAH,EAA7C,UAA+D,aAAGG,IAAH,EAArE;AACAV,MAAIW,IAAJ,CAAS,EAAEC,IAAIb,IAAIa,EAAV,EAAcR,kBAAd,EAAwBG,kBAAxB,EAAT;AACA,EALD;;AAOA,QAAOX,GAAP;AACA,C","file":"index.js","sourcesContent":["import { version } from '../../package.json';\r\nimport { Router } from 'express';\r\nimport acceptLanguageParser from 'accept-language-parser';\r\nimport os from 'os';\r\nimport facets from './facets';\r\n\r\nexport default ({ config, db }) => {\r\n\tlet api = Router();\r\n\r\n\t// mount the facets resource\r\n\tapi.use('/facets', facets({ config, db }));\r\n\r\n\t// perhaps expose some API metadata at the root\r\n\tapi.get('/whoami', (req, res) => {\r\n\t\tconst parsedLanguage = acceptLanguageParser.parse(req.headers['accept-language'])\r\n\t\tconst language = `${parsedLanguage[0].code}-${parsedLanguage[0].region}`\r\n\t\tconst platform = `${os.type()}; ${os.release()}; ${os.platform()}; ${os.arch()}`\r\n\t\tres.json({ ip: req.ip, language, platform});\r\n\t});\r\n\r\n\treturn api;\r\n}\r\n"]}